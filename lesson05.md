# Урок 5. Функції

![](images/functions.jpg)

## Термінологія на урок:

**Функцією** називається окремий блок програми. Він може мати ім'я, він може приймати аргументи, з якими потім працюватиме, і він може повертати результат своєї роботи.

**Параметрами** функції називаються спеціальні змінні, які прийматимуть конкретні значення під час виклику цієї функції. Вони також є локальними змінними всередині цієї функції, які приймають аргументи як значення. Альтернативна назва - формальні параметри.

**Аргументами** або фактичними параметрами називаються змінні (вирази, літерали та ін), передані в функцію при виклику. По суті, аргументи – це джерело реальних значень параметрів функції за її виклику.

**Літерал** - фактичне значення, яке записується у змінну чи передається у функцію. Наприклад, у записі `x = 1` літералом є 1.

### Створення, або оголошення функції

В Python функція створюється наступним чином:

```python
def say_hello():
    return "Hello"
```

**Найважливіші елементи функції:**

- ключове слово **`def`** свідчить, що далі буде функція
- після def слідує назва функції, наведена вище називається **`say_hello`**
- потім йдуть дужки з параметрами функції
- після дужки йде двокрапка. Як ми знаємо, двокрапка в Python означає, що далі буде якийсь блок коду, виділений відступами. У разі умови це блок умови, тіло умови, у випадку з циклом - тіло циклу, у випадку з функцією - тіло функції або код функції
- ключове слово **`return`** використовується в тілі функції, щоб завершити роботу функції і повернути її результат. Якщо не написати **`return`**, функція поверне **`None`**. Гарним тоном буде повертати якесь значення явно
- результат роботи функції – результат виконання функції, який вона повертає. У наведеному прикладі результатом роботи функції буде рядок "Hello", з функції він повернеться завдяки ключовому слову **`return`**.

У Python прийнято тіло функції, як і тіло будь-якого блоку, виділяти відступом у 4 пробіли.

![](images/pain.jpg)

**Все, що ми обговорюємо - лише створення функції, але не використання її. Для використання функції її потрібно викликати.**

### Виклик функції (function call)

Створену (оголошену) функцію необхідно викликати, щоб вона виконала своє завдання. Доки функція не викликана, вона марна і нічого не робить.

Якщо просто написати функцію і викликати її, ми не побачимо результат, що повертається. Він повернеться, але після цього загубиться. Для того, щоб цей результат не втратити, його потрібно передати в роботу іншої функції, зберегти змінну або будь-яким іншим чином зловити обробити. Наприклад, помістимо її в функцію **`print`** як аргумент.

Викликаємо нашу функцію **`say_hello:`**

```python
print(say_hello()) # Hello
```

### Параметри та аргументи функції

Функції також можуть приймати параметри:

```python
def plus(num1, num2):
    result = num1 + num2
    return result
```

Тут **`num1`** і **`num2`** - параметри функції **`plus`**.

#### Аргументи чи парметри? Локальні та глобальні змінні

При створенні функції ви описуєте параметри, під час виклику - передаєте аргументи. Значення аргументів потрапляють у параметри і всередині функції - це параметри або просто локальні змінні.

Щодо локальних та глобальних змінних:

```python
test_var = "Global value"

def use_global():
	print(f'`use_global` function has: {test_var}\n')

def use_local():
	test_var = "Local value"
	print(f'`use_local` function has: {test_var}\n')

def change_global():
	global test_var
	test_var += " and local value"
	print(f'`change_global` function has: {test_var}\n')


print(f'Global variable equals to {test_var}\n')
use_global()
print(f'Global variable equals to {test_var}\n')
use_local()
print(f'Global variable equals to {test_var}\n')
change_global()
print(f'Global variable equals to {test_var}\n')

```

У Python, якщо ви декларуєте параметри, ви зобов'язані передати відповідні аргументи, інакше отримаєте помилку. Викликаємо нашу функцію plus з двома числами-аргументами - **10** і **5**:

```python
ten = 10
five = 5

plus(ten, five)
# returned 15

plus(10, 5)
# returned 15

```
У момент виконання функції параметри `num1` і `num2` приймуть значення `10` та `5` відповідно.  

Також в python можна передавати аргументи не по порядку, але з явною вказівкою аргументу та відповідністю аргументу переданому значенню

```python
plus(num1=10, num2=5)

plus(num2=5, num1=10)
```

### Види параметрів функції


```python
def func(positional, keyword=value, *args, **kwargs)
    pass

```

У Python можна розрізнити 4 види параметрів функції:

1. **Позиційні аргументи** є обов'язковими і не мають значень за замовчуваанням.
2. **Аргументи з ключовим словом** необов'язкові і мають значення за замовчуваанням.
3. **Список із довільною кількістю аргументів** необов'язковий і не має значень за замовчуваанням.
4. **Словник із довільною кількістю аргументів** із ключовим словом необов'язковий і не має значень за замовчуваанням.

```python

def test(a, b=10, *c, **d):
    summa = a + b
    if c:
        summa += sum(c)
    if d:
        summa += sum(d.values())
    
    return summa

print(test(15))                         # 25
print(test(15, 5))                      # 20
print(test(15, 5, 1, 2, 3))             # 26
print(test(15, 5, 1, 2, 3, x=10, y=20)) # 56
```

### Функция как тип данных

Все в Python является объектом. Функции не выделяются и тоже являются объектами. Как и любые други типы данных, функции можно хранить в переменных, передавать параметрами в другие функции и хранить в словарях, списках и кортежах:

Пример передачи функции в качестве параметра:

```python
def run_operation(num1, num2, operation):
    return operation(num1, num2)

def plus(num1, num2):
    return num1 + num2

minus = lambda num1, num2: num1 - num2

run_operation(10, 5, plus)  # 15
run_operation(10, 5, minus) # 5
```


Хранение функции в словаре:

```python

functions_dict = {
    'plus': plus,
    'minus': minus
}

def operation(num1, num2, func_dict, func_name):
    return func_dict[func_name](num1, num2)

operation(2, 3, function_dict, 'plus')
```

### Лямбда выражения

В языке python нет анонимных функций в обычном виде, но есть однострочные лямбда-выражения, которые могут использоваться в качестве замены маленьких функций.

![](images/lambdas.png)

Синтаксис у них следующий:
ключевое слово `lambda`, затем перечень параметров, затем двоеточие - и в той же строке выражение, аналогичное выражению после ключевого слова return в обычной однострочной функции:
`lambda arguments : expression`

Примеры:
```python
lambda age: 'Senior' if age > 55 else 'Adult'

(lambda x, y: x + y)(2, 3)
```


### Функции высшего порядка на примере Map, Filter, Reduce

Функция map принимает два параметра: функцию и итератор, например, список.

`map` применяет к каждому элементу списка переданную функцию. 

```python
string_numbers = ['1', '2', '3', '4', '5']
new_list = list(map(int, string_numbers))
print(new_list)
#  [1, 2, 3, 4, 5, 6, 7]
```

Еще один пример:

```python
def my_square(num):
    return num ** 2

numbers = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]

squared_numbers = list(map(my_square, numbers))

print(squared_numbers)

# [1, 4, 9, 16, 25, 36, 49, 64, 81, 100]
```

Аналогичным образом в любую функцию высшего порядка можно передавать не только встроенную функцию, но и самописную, и лямбда-выражение.

Функция `filter` принимает два аргумента: какой функцией фильтровать итератор и сам итератор. Функция должна возвращать `True` или `False`. При помощи функции из первого параметра `filter` создает ленивый итератор из тех значений входящего итератора, которые прошли проверку. 
В примере ниже провкерку пройдут только нечетные числа:

```python
filter(lambda x: x % 2, range(10))
```

Функция `reduce` при помощи первого параметра - функции сводит второй параметр - итератор к одному значению. Для применения функции нужно подключать библиотеку `functools`. Пример:

```python
functools.reduce(lambda x, y: x+y, list_of_numbers)
```
## Практика

#### Задание 1
Написать 2 функции.
Первая функция будет принимать строку и приводить ее к нижнему регистру.

Вторая функция будет принимать строку и проводить ее к верхнему регистру.

После чего с помощью `map` применить ваши  функции к списку строк.
Отдельно каждую функцию к отдельному списку строк!

#### Задание 2
Написать функцию которая будет простое число возводить в квардрат.

Необходимо возвести в квадрат все простые числа в списке используя функцию `map`

#### Задание 3
Вспоминаем работу с файлом. Есть файл, в котором много англоязычных текстовых строк. Считаем частоту встретившихся слов в файле, но через функции и `map`, без единого цикла!


## Ссылки

[**ZIP**](https://tproger.ru/translations/implementing-zip-list-comprehensions/)

[**Map, Zip, Lambda**](http://ninjaside.info/blog/ru/funkcii-map-i-zip-i-lambda-python/)

[**Lambda article**](https://realpython.com/python-lambda/)

[Домашка](hw05.md)

[Следующий урок](lesson06.md)
